--- stratagems/mage/ssl/bg1/combatblocks/attacks_on_PC_defences.ssl	2016-11-20 18:27:15.402473500 -0500
+++ Fixpack/stratagems/mage/ssl/bg1/combatblocks/attacks_on_PC_defences.ssl	2016-12-01 15:11:46.505884400 -0500
@@ -22,7 +22,7 @@
 	IgnoreBlock(SpellsAreBG1)
 	RequireBlock(HasL5)
 	TargetBlock(PCsInOrder)
-	TriggerBlock(SpellTurn|Enemy|Helpless)
+	TriggerBlock(SpellTurn|SpellTurnNew|Enemy|Helpless)
 	OR(3)
 		CheckStatGT(scstarget,0,SCRIPTINGSTATE2)
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
@@ -63,7 +63,7 @@
 		!CheckStatGT(Playerscsvar,0,WIZARD_GREATER_MALISON)
 		!Allegiance(Playerscsvar,ENEMY)
 	END LOOP
-	TriggerBlock(SIAbjuration|Enemy)
+	TriggerBlock(Enemy)
 THEN DO
 	Combine()
 	SetGlobalTimer("DMWW_dispel","LOCALS",18)
--- stratagems/mage/ssl/bg2/combatblocks/attacks_on_pc_defences.ssl	2016-11-20 18:27:15.402473500 -0500
+++ Fixpack/stratagems/mage/ssl/bg2/combatblocks/attacks_on_pc_defences.ssl	2016-12-01 15:11:46.505884400 -0500
@@ -14,7 +14,7 @@
 IF TRIGGER
 	IgnoreBlock(Indiscriminate)
 	TargetBlock(PCsInOrder)
-	TriggerBlock(SpellTurn|SIAbjuration|Enemy|Helpless)
+	TriggerBlock(SpellTurn|SpellTurnNew|Enemy|Helpless)
 	CheckStatGT(scstarget,99,MAGICDAMAGERESISTANCE)
 	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
 	RequireBlock(HasL8)
@@ -40,12 +40,13 @@
 IF TRIGGER
 	IgnoreBlock(Indiscriminate)
 	TargetBlock(PCsInOrder)
-	TriggerBlock(SpellTurn|SIAbjuration|Enemy|Helpless)
-	OR(4)
+	TriggerBlock(SpellTurn|SpellTurnNew|Enemy|Helpless)
+	OR(5)
 		!CheckStatGT(scstarget,-10,SAVEVSSPELL) // a rough indicator of a potion of Magic Shielding
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
 		CheckStatGT(scstarget,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
 		CheckStatGT(scstarget,2,STONESKINS)
+		CheckStat(scstarget,4,WIZARD_SPELL_IMMUNITY)
 	!GlobalTimerNotExpired("DMWW_breach","LOCALS")
 	RequireBlock(HasL5)
 	OR(2)
@@ -67,12 +68,13 @@
 IF TRIGGER
 	RequireBlock(Indiscriminate)
 	TargetBlock(EnemiesInOrder)
-	TriggerBlock(SpellTurn|SIAbjuration|Helpless)
-	OR(4)
+	TriggerBlock(SpellTurn|SpellTurnNew|Helpless)
+	OR(5)
 		!CheckStatGT(scstarget,-10,SAVEVSSPELL) // a rough indicator of a potion of Magic Shielding
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
 		CheckStatGT(scstarget,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
 		CheckStatGT(scstarget,2,STONESKINS)
+		CheckStat(scstarget,4,WIZARD_SPELL_IMMUNITY)
 	!GlobalTimerNotExpired("DMWW_breach","LOCALS")
 	RequireBlock(HasL5)
 	OR(2)
@@ -129,10 +131,9 @@
 IF TRIGGER
 	IgnoreBlock(Indiscriminate)
 	TargetBlock(PCSpellcasters)
-	OR(5)
+	OR(4)
 		CheckStatGT(scstarget,0,WIZARD_SPELL_TURNING)
 		CheckStatGT(scstarget,0,WIZARD_SPELL_DEFLECTION)
-		CheckStatGT(scstarget,0,WIZARD_SPELL_IMMUNITY)
 		CheckStatGT(scstarget,0,MINORGLOBE)
 		CheckStatGT(scstarget,0,CLERIC_SHIELD_OF_THE_ARCHONS)
 	TriggerBlock(Enemy|Helpless)
@@ -180,7 +181,7 @@
 		!CheckStatGT(Playerscsvar,0,CLERIC_INSECT_PLAGUE)
 		!Allegiance(Playerscsvar,ENEMY)
 	END LOOP
-	TriggerBlock(SIAbjuration|Enemy)
+	TriggerBlock(Enemy)
 	OR(2)
 		!GlobalTimerNotExpired("DMWWTimestopRunning","GLOBAL")
 		!GlobalTimerNotExpired("timestop_antimagic","LOCALS")
@@ -204,18 +205,19 @@
 		HasItem("dw#dispe",Myself)
 	TargetBlock(PCsInOrder)
 	RequireBlock(HasL3)
-	OR(4)
+	OR(5)
 		!CheckStatGT(scstarget,-10,SAVEVSSPELL) // a rough indicator of a potion of Magic Shielding
 		CheckStatGT(scstarget,0,STONESKINS)
 		CheckStatGT(scstarget,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
+		CheckStat(scstarget,4,WIZARD_SPELL_IMMUNITY)
 	BEGIN LOOP(scsvar||1;2;3;4;5;6)
 		!StateCheck(Playerscsvar,STATE_DISABLED)
 		!CheckStatGT(Playerscsvar,0,CLERIC_INSECT_PLAGUE)
 		!CheckStatGT(Playerscsvar,0,WIZARD_GREATER_MALISON)
 		!Allegiance(Playerscsvar,ENEMY)
 	END LOOP
-	TriggerBlock(SIAbjuration|Enemy)
+	TriggerBlock(Enemy)
 	OR(2)
 		!GlobalTimerNotExpired("DMWWTimestopRunning","GLOBAL")
 		!GlobalTimerNotExpired("timestop_antimagic","LOCALS")
@@ -240,13 +242,13 @@
 		HasItem("dw#dispe",Myself)
 	TargetBlock(EnemiesInOrder)
 	RequireBlock(HasL3)
-	OR(5)
+	OR(6)
 	     	CheckStatGT(scstarget,99,MAGICDAMAGERESISTANCE)
 		!CheckStatGT(scstarget,-10,SAVEVSSPELL) // a rough indicator of a potion of Magic Shielding
 		CheckStatGT(scstarget,0,STONESKINS)
 		CheckStatGT(scstarget,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
-	TriggerBlock(SIAbjuration)
+		CheckStat(scstarget,4,WIZARD_SPELL_IMMUNITY)
 	OR(2)
 		!GlobalTimerNotExpired("DMWWTimestopRunning","GLOBAL")
 		!GlobalTimerNotExpired("timestop_antimagic","LOCALS")
@@ -296,7 +298,7 @@
 	IgnoreBlock(Indiscriminate)
 	TargetBlock(PCsInOrder)
 	RequireBlock(HasL3)
-	CheckStatGT(scstarget,0,WIZARD_SPELL_IMMUNITY)
+	CheckStatGT(scstarget,0,WIZARD_SPELL_DEFLECTION)
 	TriggerBlock(Enemy|Helpless)
 	!GlobalTimerNotExpired("DMWW_antimagic","LOCALS")
 	OR(2)
@@ -345,7 +347,7 @@
 		CheckStatGT(scstarget,0,PROTECTION_FROM_EVIL)
 		CheckStatGT(scstarget,0,CLERIC_PHYSICAL_MIRROR)
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
-		CheckStatGT(scstarget,0,WIZARD_PROTECTION_FROM_PETRIFICATION)
+		CheckStat(scstarget,4,WIZARD_SPELL_IMMUNITY)
 		CheckStatGT(scstarget,0,SCRIPTINGSTATE2)
 	BEGIN LOOP(scsvar||1;2;3;4;5;6)
 		!StateCheck(Playerscsvar,STATE_DISABLED)
@@ -353,7 +355,7 @@
 		!CheckStatGT(Playerscsvar,0,WIZARD_GREATER_MALISON)
 		!Allegiance(Playerscsvar,ENEMY)
 	END LOOP
-	TriggerBlock(SIAbjuration|Enemy)
+	TriggerBlock(Enemy)
 	OR(2)
 		!GlobalTimerNotExpired("DMWWTimestopRunning","GLOBAL")
 		!GlobalTimerNotExpired("timestop_antimagic","LOCALS")
@@ -390,9 +392,9 @@
 		CheckStatGT(scstarget,0,PROTECTION_FROM_EVIL)
 		CheckStatGT(scstarget,0,CLERIC_PHYSICAL_MIRROR)
 		CheckStatGT(scstarget,0,CLERIC_CHAOTIC_COMMANDS)
-		CheckStatGT(scstarget,0,WIZARD_PROTECTION_FROM_PETRIFICATION)
+		CheckStat(scstarget,4,WIZARD_SPELL_IMMUNITY)
 		CheckStatGT(scstarget,0,SCRIPTINGSTATE2)
-	TriggerBlock(SIAbjuration)
+	TriggerBlock(Enemy)
 	OR(2)
 		!GlobalTimerNotExpired("DMWWTimestopRunning","GLOBAL")
 		!GlobalTimerNotExpired("timestop_antimagic","LOCALS")
